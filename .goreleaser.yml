# This is an example goreleaser.yaml file with some sane defaults.
# Make sure to check the documentation at http://goreleaser.com
before:
  hooks:
    # You may remove this if you don't use go modules.
    - go mod download

builds:
  - env:
      - CGO_ENABLED=0
    goos:
      - linux
      - windows
      - darwin

  - main: ./cmd/jaxctl
    id: "jaxctl"
    binary: jaxctl
    goos:
      - linux
      - darwin
      - windows

archives:
  - replacements:
      darwin: Darwin
      linux: Linux
      windows: Windows
      386: i386
      amd64: x86_64

dockers:
  - image_templates: ["gitlab.com/jaxnet/jaxnetd:{{ .Version }}"]
    dockerfile: Dockerfile
    build_flag_templates:
      - --label=org.opencontainers.image.title={{ .ProjectName }}
      - --label=org.opencontainers.image.description={{ .ProjectName }}
      - --label=org.opencontainers.image.url=https://gitlab.com/jaxnet/jaxnetd
      - --label=org.opencontainers.image.source=https://gitlab.com/jaxnet/jaxnetd
      - --label=org.opencontainers.image.version={{ .Version }}
      - --label=org.opencontainers.image.created={{ time "2006-01-02T15:04:05Z07:00" }}
      - --label=org.opencontainers.image.revision={{ .FullCommit }}
      - --label=org.opencontainers.image.licenses=ISC

nfpms:
  - maintainer: JAX.Net Devs <mike@jax.net>
    description: The JAX.Network node
    homepage: https://jax.network
    license: ISC
    formats:
      - deb
      - rpm
      - apk

checksum:
  name_template: 'checksums.txt'
snapshot:
  name_template: "{{ .Tag }}-next"

changelog:
  sort: asc
  filters:
    exclude:
      - '^docs:'
      - '^test:'

release:
  # Repo in which the release will be created.
  # Default is extracted from the origin remote URL or empty if its private hosted.
  # Note: it can only be one: either github, gitlab or gitea
  gitlab:
    owner: jaxnet
    name: jaxnetd

#gitlab_urls:
#  api: https://gitlab.com/api/v4/
#  download: https://gitlab.com/jaxnet/jaxnetd
#  # set to true if you use a self-signed certificate
#  skip_tls_verify: false
